<!DOCTYPE html>
<html>
<head>
    <meta content="utf-8" http-equiv="encoding">
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta name="user-scalable" content="no">

    <title>Rise of Kings</title>
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="/css/style.css" type="text/css">

</head>
<body>
    <table id="lobby">
        <caption><b>Lobby Browser</b></caption>
        <tr>
            <th>Name</th>
            <th>ID</th>
            <th>Players</th>
        </tr>
    </table>

    <a class="button" id="host-btn" href="host.html">Host Game</a>
    <a class="button" id="join-btn" href="javascript:;">Join Game</a>
    <a class="button" id="join-btn" href="javascript:refresh();">Refresh</a>

    <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
    <script src="http://cdn.peerjs.com/0.3/peer.min.js"></script>
    <script type="text/javascript" src="/zogl/js/zogl.min.js"></script>

    <script type="text/javascript" src="/js/net/config.js"></script>
    <script type="text/javascript" src="/js/net/matchmaker.js"></script>
    <script>
        window.onload = function() {
            refresh();
        };

        function refresh() {
            net.helpers.ajax("GET", net.config.AUTH_URL + "/match/", {
                onReady: function(resp) {

                    console.log(resp);

                    var elem = document.getElementById("lobby")
                                       .getElementsByTagName("tbody")[0];

                    elem.innerHTML = elem.rows[0].innerHTML;

                    var json = JSON.parse(resp);
                    for (var i in json["matches"]) {
                        var peer = json["matches"][i];

                        var dom = document.createElement("tr");
                        dom.innerHTML =
                            "<td>" + peer.name + "</td>" +
                            "<td>" + peer.host.id + "</td>" +
                            "<td>" + peer.players.length + "</td>";
                        elem.appendChild(dom);
                    }
                }
            });
        }
    </script>
</body>
</html>
